geom_line(data = circles , aes(genome_size,y2), color="#333333",size=1.5) +
geom_jitter(data = variants1, aes(var1.pos, var1.height), size=3, color="#C02942", height=0.05, width = 0.05, alpha=0.7) +
geom_jitter(data = variants2, aes(var2.pos, var2.height), size=3, color="#ECD078", height=0.05, width = 0.05, alpha=0.7) +
coord_polar() +
ylim(c(0,NA)) +
geom_text(data = ticks, aes(x, y, label = "|", angle = angle)) +
geom_text(data = ticks, aes(x, y, label = as.character(x), angle = angle)) +
theme_void() +
labs(title="Ploting variant positions across genome") +
theme(plot.title = element_text(hjust=0.5))
ticks <- data.frame(
x=seq(0,5500000,500000),
y1=rep(0.5,12),
y2=rep(0.3,12),
angle=360000-seq(0,330,30)
)
ticks
ggplot() +
geom_rect(xmin=0, xmax=6000000, ymin= 1.1, ymax=1.5, fill="#eae3dc") +
geom_line(data = circles , aes(genome_size,y1), color="#333333",size=1) +
geom_line(data = circles , aes(genome_size,y2), color="#333333",size=1.5) +
geom_jitter(data = variants1, aes(var1.pos, var1.height), size=3, color="#C02942", height=0.05, width = 0.05, alpha=0.7) +
geom_jitter(data = variants2, aes(var2.pos, var2.height), size=3, color="#ECD078", height=0.05, width = 0.05, alpha=0.7) +
coord_polar() +
ylim(c(0,NA)) +
geom_text(data = ticks, aes(x, y, label = "|", angle = angle)) +
geom_text(data = ticks, aes(x, y, label = as.character(x), angle = angle)) +
theme_void() +
labs(title="Ploting variant positions across genome") +
theme(plot.title = element_text(hjust=0.5))
ggplot() +
geom_rect(xmin=0, xmax=6000000, ymin= 1.1, ymax=1.5, fill="#eae3dc") +
geom_line(data = circles , aes(genome_size,y1), color="#333333",size=1) +
geom_line(data = circles , aes(genome_size,y2), color="#333333",size=1.5) +
geom_jitter(data = variants1, aes(var1.pos, var1.height), size=3, color="#C02942", height=0.05, width = 0.05, alpha=0.7) +
geom_jitter(data = variants2, aes(var2.pos, var2.height), size=3, color="#ECD078", height=0.05, width = 0.05, alpha=0.7) +
coord_polar() +
ylim(c(0,NA)) +
geom_text(data = ticks, aes(x, y1, label = "|", angle = angle)) +
geom_text(data = ticks, aes(x, y2, label = as.character(x), angle = angle)) +
theme_void() +
labs(title="Ploting variant positions across genome") +
theme(plot.title = element_text(hjust=0.5))
ggplot() +
geom_rect(xmin=0, xmax=6000000, ymin= 1.1, ymax=1.5, fill="#eae3dc") +
geom_line(data = circles , aes(genome_size,y1), color="#333333",size=1) +
geom_line(data = circles , aes(genome_size,y2), color="#333333",size=1.5) +
geom_jitter(data = variants1, aes(var1.pos, var1.height), size=3, color="#C02942", height=0.05, width = 0.05, alpha=0.7) +
geom_jitter(data = variants2, aes(var2.pos, var2.height), size=3, color="#ECD078", height=0.05, width = 0.05, alpha=0.7) +
coord_polar() +
ylim(c(0,NA)) +
geom_text(data = ticks, aes(x, y1, label = "|", angle = angle)) +
geom_text(data = ticks, aes(x, y2, label = as.character(x), angle = angle,size=0.5)) +
theme_void() +
labs(title="Ploting variant positions across genome") +
theme(plot.title = element_text(hjust=0.5))
ggplot() +
geom_rect(xmin=0, xmax=6000000, ymin= 1.1, ymax=1.5, fill="#eae3dc") +
geom_line(data = circles , aes(genome_size,y1), color="#333333",size=1) +
geom_line(data = circles , aes(genome_size,y2), color="#333333",size=1.5) +
geom_jitter(data = variants1, aes(var1.pos, var1.height), size=3, color="#C02942", height=0.05, width = 0.05, alpha=0.7) +
geom_jitter(data = variants2, aes(var2.pos, var2.height), size=3, color="#ECD078", height=0.05, width = 0.05, alpha=0.7) +
coord_polar() +
ylim(c(0,NA)) +
geom_text(data = ticks, aes(x, y1, label = "|", angle = angle)) +
geom_text(data = ticks, aes(x, y2, label = as.character(x), angle = angle), size=0.2) +
theme_void() +
labs(title="Ploting variant positions across genome") +
theme(plot.title = element_text(hjust=0.5))
ggplot() +
geom_rect(xmin=0, xmax=6000000, ymin= 1.1, ymax=1.5, fill="#eae3dc") +
geom_line(data = circles , aes(genome_size,y1), color="#333333",size=1) +
geom_line(data = circles , aes(genome_size,y2), color="#333333",size=1.5) +
geom_jitter(data = variants1, aes(var1.pos, var1.height), size=3, color="#C02942", height=0.05, width = 0.05, alpha=0.7) +
geom_jitter(data = variants2, aes(var2.pos, var2.height), size=3, color="#ECD078", height=0.05, width = 0.05, alpha=0.7) +
coord_polar() +
ylim(c(0,NA)) +
geom_text(data = ticks, aes(x, y1, label = "|", angle = angle)) +
geom_text(data = ticks, aes(x, y2, label = as.character(x), angle = angle, size=0.2)) +
theme_void() +
labs(title="Ploting variant positions across genome") +
theme(plot.title = element_text(hjust=0.5))
ggplot() +
geom_rect(xmin=0, xmax=6000000, ymin= 1.1, ymax=1.5, fill="#eae3dc") +
geom_line(data = circles , aes(genome_size,y1), color="#333333",size=1) +
geom_line(data = circles , aes(genome_size,y2), color="#333333",size=1.5) +
geom_jitter(data = variants1, aes(var1.pos, var1.height), size=3, color="#C02942", height=0.05, width = 0.05, alpha=0.7) +
geom_jitter(data = variants2, aes(var2.pos, var2.height), size=3, color="#ECD078", height=0.05, width = 0.05, alpha=0.7) +
coord_polar() +
ylim(c(0,NA)) +
geom_text(data = ticks, aes(x, y1, label = "|", angle = angle)) +
geom_text(data = ticks, aes(x, y2, label = as.character(x), angle = angle, size=0.1)) +
theme_void() +
labs(title="Ploting variant positions across genome") +
theme(plot.title = element_text(hjust=0.5))
ticks
x1
x1=seq(0,5500000,500000),
ggplot() +
geom_rect(xmin=0, xmax=6000000, ymin= 1.1, ymax=1.5, fill="#eae3dc") +
geom_line(data = circles , aes(genome_size,y1), color="#333333",size=1) +
geom_line(data = circles , aes(genome_size,y2), color="#333333",size=1.5) +
geom_jitter(data = variants1, aes(var1.pos, var1.height), size=3, color="#C02942", height=0.05, width = 0.05, alpha=0.7) +
geom_jitter(data = variants2, aes(var2.pos, var2.height), size=3, color="#ECD078", height=0.05, width = 0.05, alpha=0.7) +
coord_polar() +
ylim(c(0,NA)) +
geom_text(data = ticks, aes(x, y1, label = "|", angle = angle)) +
geom_text(data = ticks, aes(x, y2, label = as.character(x), angle = angle, size=0.1)) +
theme_void() +
labs(title="Ploting variant positions across genome") +
theme(plot.title = element_text(hjust=0.5))
x1=seq(0,5500000,500000)
paste0(0:5500000,M)
paste0(0:5500000,"M")
paste0(0:5500000,500000,"M")
paste0(0:2,1,"M")
x1=seq(0,5500000,500000)
paste0(x1," M")
paste0(x1/1000000," M")
paste0((seq(0,5.5,0.5))," M")
ticks <- data.frame(
x1=seq(0,5500000,500000),
y1=rep(0.5,12),
y2=rep(0.3,12),
x2=paste0((seq(0,5.5,0.5))," M"),
angle=360000-seq(0,330,30)
)
ticks <- data.frame(
x1=seq(0,5500000,500000),
y1=rep(0.5,12),
y2=rep(0.3,12),
x2=paste0((seq(0,5.5,0.5))," M"),
angle=360000-seq(0,330,30)
)
ggplot() +
geom_rect(xmin=0, xmax=6000000, ymin= 1.1, ymax=1.5, fill="#eae3dc") +
geom_line(data = circles , aes(genome_size,y1), color="#333333",size=1) +
geom_line(data = circles , aes(genome_size,y2), color="#333333",size=1.5) +
geom_jitter(data = variants1, aes(var1.pos, var1.height), size=3, color="#C02942", height=0.05, width = 0.05, alpha=0.7) +
geom_jitter(data = variants2, aes(var2.pos, var2.height), size=3, color="#ECD078", height=0.05, width = 0.05, alpha=0.7) +
coord_polar() +
ylim(c(0,NA)) +
geom_text(data = ticks, aes(x1, y1, label = "|", angle = angle)) +
geom_text(data = ticks, aes(x2, y2, label = as.character(x), angle = angle, size=0.1)) +
theme_void() +
labs(title="Ploting variant positions across genome") +
theme(plot.title = element_text(hjust=0.5))
ticks <- data.frame(
x1=seq(0,5500000,500000),
y1=rep(0.5,12),
y2=rep(0.3,12),
x2=paste0((seq(0,5.5,0.5))," M"),
angle=360000-seq(0,330,30)
)
ggplot() +
geom_rect(xmin=0, xmax=6000000, ymin= 1.1, ymax=1.5, fill="#eae3dc") +
geom_line(data = circles , aes(genome_size,y1), color="#333333",size=1) +
geom_line(data = circles , aes(genome_size,y2), color="#333333",size=1.5) +
geom_jitter(data = variants1, aes(var1.pos, var1.height), size=3, color="#C02942", height=0.05, width = 0.05, alpha=0.7) +
geom_jitter(data = variants2, aes(var2.pos, var2.height), size=3, color="#ECD078", height=0.05, width = 0.05, alpha=0.7) +
coord_polar() +
ylim(c(0,NA)) +
geom_text(data = ticks, aes(x1, y1, label = "|", angle = angle)) +
geom_text(data = ticks, aes(x1, y2, label = x2, angle = angle, size=0.1)) +
theme_void() +
labs(title="Ploting variant positions across genome") +
theme(plot.title = element_text(hjust=0.5))
ggplot() +
geom_rect(xmin=0, xmax=6000000, ymin= 1.1, ymax=1.5, fill="#eae3dc") +
geom_line(data = circles , aes(genome_size,y1), color="#333333",size=1) +
geom_line(data = circles , aes(genome_size,y2), color="#333333",size=1.5) +
geom_jitter(data = variants1, aes(var1.pos, var1.height), size=3, color="#C02942", height=0.05, width = 0.05, alpha=0.7) +
geom_jitter(data = variants2, aes(var2.pos, var2.height), size=3, color="#ECD078", height=0.05, width = 0.05, alpha=0.7) +
coord_polar() +
ylim(c(0,NA)) +
geom_text(data = ticks, aes(x1, y1, label = "|", angle = angle)) +
geom_text(data = ticks, aes(x1, y2, label = x2, angle = angle, size=0.01)) +
theme_void() +
labs(title="Ploting variant positions across genome") +
theme(plot.title = element_text(hjust=0.5))
ggplot() +
geom_rect(xmin=0, xmax=6000000, ymin= 1.1, ymax=1.5, fill="#eae3dc") +
geom_line(data = circles , aes(genome_size,y1), color="#333333",size=1) +
geom_line(data = circles , aes(genome_size,y2), color="#333333",size=1.5) +
geom_jitter(data = variants1, aes(var1.pos, var1.height), size=3, color="#C02942", height=0.05, width = 0.05, alpha=0.7) +
geom_jitter(data = variants2, aes(var2.pos, var2.height), size=3, color="#ECD078", height=0.05, width = 0.05, alpha=0.7) +
coord_polar() +
ylim(c(0,NA)) +
geom_text(data = ticks, aes(x1, y1, label = "|", angle = angle)) +
geom_text(data = ticks, aes(x1, y2, label = x2, angle = angle, size=0.001)) +
theme_void() +
labs(title="Ploting variant positions across genome") +
theme(plot.title = element_text(hjust=0.5))
ggplot() +
geom_rect(xmin=0, xmax=6000000, ymin= 1.1, ymax=1.5, fill="#eae3dc") +
geom_line(data = circles , aes(genome_size,y1), color="#333333",size=1) +
geom_line(data = circles , aes(genome_size,y2), color="#333333",size=1.5) +
geom_jitter(data = variants1, aes(var1.pos, var1.height), size=3, color="#C02942", height=0.05, width = 0.05, alpha=0.7) +
geom_jitter(data = variants2, aes(var2.pos, var2.height), size=3, color="#ECD078", height=0.05, width = 0.05, alpha=0.7) +
coord_polar() +
ylim(c(0,NA)) +
geom_text(data = ticks, aes(x1, y1, label = "|", angle = angle)) +
geom_text(data = ticks, aes(x1, y2, label = x2, angle = angle, size=0.00001)) +
theme_void() +
labs(title="Ploting variant positions across genome") +
theme(plot.title = element_text(hjust=0.5))
ticks <- data.frame(
x1=seq(0,5500000,500000),
y1=rep(0.6,12),
y2=rep(0.5,12),
x2=paste0((seq(0,5.5,0.5))," M"),
angle=360000-seq(0,330,30)
)
ggplot() +
geom_rect(xmin=0, xmax=6000000, ymin= 1.1, ymax=1.5, fill="#eae3dc") +
geom_line(data = circles , aes(genome_size,y1), color="#333333",size=1) +
geom_line(data = circles , aes(genome_size,y2), color="#333333",size=1.5) +
geom_jitter(data = variants1, aes(var1.pos, var1.height), size=3, color="#C02942", height=0.05, width = 0.05, alpha=0.7) +
geom_jitter(data = variants2, aes(var2.pos, var2.height), size=3, color="#ECD078", height=0.05, width = 0.05, alpha=0.7) +
coord_polar() +
ylim(c(0,NA)) +
geom_text(data = ticks, aes(x1, y1, label = "|", angle = angle)) +
geom_text(data = ticks, aes(x1, y2, label = x2, angle = angle, size=0.00001)) +
theme_void() +
labs(title="Ploting variant positions across genome") +
theme(plot.title = element_text(hjust=0.5))
ticks <- data.frame(
x1=seq(0,5500000,500000),
y1=rep(0.6,12),
y2=rep(0.5,12),
x2=paste0((seq(0,5.5,0.5))),
angle=360000-seq(0,330,30)
)
ggplot() +
geom_rect(xmin=0, xmax=6000000, ymin= 1.1, ymax=1.5, fill="#eae3dc") +
geom_line(data = circles , aes(genome_size,y1), color="#333333",size=1) +
geom_line(data = circles , aes(genome_size,y2), color="#333333",size=1.5) +
geom_jitter(data = variants1, aes(var1.pos, var1.height), size=3, color="#C02942", height=0.05, width = 0.05, alpha=0.7) +
geom_jitter(data = variants2, aes(var2.pos, var2.height), size=3, color="#ECD078", height=0.05, width = 0.05, alpha=0.7) +
coord_polar() +
ylim(c(0,NA)) +
geom_text(data = ticks, aes(x1, y1, label = "|", angle = angle)) +
geom_text(data = ticks, aes(x1, y2, label = x2, angle = angle, size=0.00001)) +
theme_void() +
labs(title="Ploting variant positions across genome") +
theme(plot.title = element_text(hjust=0.5))
x2=paste0((seq(0,5.5,0.5)))
x2x
x2
ggplot() +
geom_rect(xmin=0, xmax=6000000, ymin= 1.1, ymax=1.5, fill="#eae3dc") +
geom_line(data = circles , aes(genome_size,y1), color="#333333",size=1) +
geom_line(data = circles , aes(genome_size,y2), color="#333333",size=1.5) +
geom_jitter(data = variants1, aes(var1.pos, var1.height), size=3, color="#C02942", height=0.05, width = 0.05, alpha=0.7) +
geom_jitter(data = variants2, aes(var2.pos, var2.height), size=3, color="#ECD078", height=0.05, width = 0.05, alpha=0.7) +
coord_polar() +
ylim(c(0,NA)) +
geom_text(data = ticks, aes(x1, y1, label = "|", angle = angle)) +
geom_text(data = ticks, aes(x1, y2, label = x2, angle = angle), size=0.5) +
theme_void() +
labs(title="Ploting variant positions across genome") +
theme(plot.title = element_text(hjust=0.5))
ggplot() +
geom_rect(xmin=0, xmax=6000000, ymin= 1.1, ymax=1.5, fill="#eae3dc") +
geom_line(data = circles , aes(genome_size,y1), color="#333333",size=1) +
geom_line(data = circles , aes(genome_size,y2), color="#333333",size=1.5) +
geom_jitter(data = variants1, aes(var1.pos, var1.height), size=3, color="#C02942", height=0.05, width = 0.05, alpha=0.7) +
geom_jitter(data = variants2, aes(var2.pos, var2.height), size=3, color="#ECD078", height=0.05, width = 0.05, alpha=0.7) +
coord_polar() +
ylim(c(0,NA)) +
geom_text(data = ticks, aes(x1, y1, label = "|", angle = angle)) +
geom_text(data = ticks, aes(x1, y2, label = x2, angle = angle), size=10) +
theme_void() +
labs(title="Ploting variant positions across genome") +
theme(plot.title = element_text(hjust=0.5))
ggplot() +
geom_rect(xmin=0, xmax=6000000, ymin= 1.1, ymax=1.5, fill="#eae3dc") +
geom_line(data = circles , aes(genome_size,y1), color="#333333",size=1) +
geom_line(data = circles , aes(genome_size,y2), color="#333333",size=1.5) +
geom_jitter(data = variants1, aes(var1.pos, var1.height), size=3, color="#C02942", height=0.05, width = 0.05, alpha=0.7) +
geom_jitter(data = variants2, aes(var2.pos, var2.height), size=3, color="#ECD078", height=0.05, width = 0.05, alpha=0.7) +
coord_polar() +
ylim(c(0,NA)) +
geom_text(data = ticks, aes(x1, y1, label = "|", angle = angle)) +
geom_text(data = ticks, aes(x1, y2, label = x2, angle = angle), size=5) +
theme_void() +
labs(title="Ploting variant positions across genome") +
theme(plot.title = element_text(hjust=0.5))
variants1 = data.frame(var1.pos = sample(1:6000000,100), var1.height = 1.3)
variants2 = data.frame(var2.pos = sample(1:6000000,100), var2.height = 0.9)
ticks <- data.frame(
x1=seq(0,5500000,500000),
y1=rep(0.6,12),
y2=rep(0.5,12),
x2=paste0((seq(0,5.5,0.5))),
angle=360000-seq(0,330,30)
)
x2=paste0((seq(0,5.5,0.5)))
ggplot() +
geom_rect(xmin=0, xmax=6000000, ymin= 1.1, ymax=1.5, fill="#eae3dc") +
geom_line(data = circles , aes(genome_size,y1), color="#333333",size=1) +
geom_line(data = circles , aes(genome_size,y2), color="#333333",size=1.5) +
geom_jitter(data = variants1, aes(var1.pos, var1.height), size=3, color="#C02942", height=0.05, width = 0.05, alpha=0.7) +
geom_jitter(data = variants2, aes(var2.pos, var2.height), size=3, color="#ECD078", height=0.05, width = 0.05, alpha=0.7) +
coord_polar() +
ylim(c(0,NA)) +
geom_text(data = ticks, aes(x1, y1, label = "|", angle = angle)) +
geom_text(data = ticks, aes(x1, y2, label = x2, angle = angle), size=5) +
theme_void() +
labs(title="Ploting variant positions across genome") +
theme(plot.title = element_text(hjust=0.5))
point.mutations = data.frame(mutations=c(0,5000000,10,1000000),
genome_coord=c(1.7,1.7,1.3,1.3),
mutation_type=c("indel","insertion"),
genome_name=c("leaky","leaky", "ANC", "ANC"),
gene_name=c("wssE","wssA","pvdI","pvdII"))
ticks <- data.frame(
x1=seq(0,5500000,500000),
y1=rep(0.7,12),
y2=rep(0.7,12),
x2=paste0((seq(0,5.5,0.5))),
angle=360000-seq(0,330,30)
)
ggplot() +
geom_rect(xmin=0, xmax=6000000, ymin= 1.1, ymax=1.5, fill="#eae3dc") +
geom_line(data = circles , aes(genome_size,y1), color="#333333",size=1) +
geom_line(data = circles , aes(genome_size,y2), color="#333333",size=1.5) +
geom_jitter(data = variants1, aes(var1.pos, var1.height), size=3, color="#C02942", height=0.05, width = 0.05, alpha=0.7) +
geom_jitter(data = variants2, aes(var2.pos, var2.height), size=3, color="#ECD078", height=0.05, width = 0.05, alpha=0.7) +
coord_polar() +
ylim(c(0,NA)) +
geom_text(data = ticks, aes(x1, y1, label = "|", angle = angle)) +
geom_text(data = ticks, aes(x1, y2, label = x2, angle = angle), size=5) +
theme_void() +
labs(title="Ploting variant positions across genome") +
theme(plot.title = element_text(hjust=0.5))
ticks <- data.frame(
x1=seq(0,5500000,500000),
y1=rep(0.7,12),
y2=rep(0.6,12),
x2=paste0((seq(0,5.5,0.5))),
angle=360000-seq(0,330,30)
)
ggplot() +
geom_rect(xmin=0, xmax=6000000, ymin= 1.1, ymax=1.5, fill="#eae3dc") +
geom_line(data = circles , aes(genome_size,y1), color="#333333",size=1) +
geom_line(data = circles , aes(genome_size,y2), color="#333333",size=1.5) +
geom_jitter(data = variants1, aes(var1.pos, var1.height), size=3, color="#C02942", height=0.05, width = 0.05, alpha=0.7) +
geom_jitter(data = variants2, aes(var2.pos, var2.height), size=3, color="#ECD078", height=0.05, width = 0.05, alpha=0.7) +
coord_polar() +
ylim(c(0,NA)) +
geom_text(data = ticks, aes(x1, y1, label = "|", angle = angle)) +
geom_text(data = ticks, aes(x1, y2, label = x2, angle = angle), size=5) +
theme_void() +
labs(title="Ploting variant positions across genome") +
theme(plot.title = element_text(hjust=0.5))
ggplot() +
geom_rect(xmin=0, xmax=6000000, ymin= 1.1, ymax=1.5, fill="#eae3dc") +
geom_line(data = circles , aes(genome_size,y1), color="#333333",size=3) +
geom_line(data = circles , aes(genome_size,y2), color="#333333",size=3.5) +
geom_jitter(data = variants1, aes(var1.pos, var1.height), size=3, color="#C02942", height=0.05, width = 0.05, alpha=0.7) +
geom_jitter(data = variants2, aes(var2.pos, var2.height), size=3, color="#ECD078", height=0.05, width = 0.05, alpha=0.7) +
coord_polar() +
ylim(c(0,NA)) +
geom_text(data = ticks, aes(x1, y1, label = "|", angle = angle)) +
geom_text(data = ticks, aes(x1, y2, label = x2, angle = angle), size=5) +
theme_void() +
labs(title="Ploting variant positions across genome") +
theme(plot.title = element_text(hjust=0.5))
ggplot() +
geom_col(data=variants1,aes(var1.pos, var1.height))
ggplot() +
geom_col(data=variants1,aes(var1.pos, var1.height), width=5)
ggplot() +
geom_col(data=variants1,aes(var1.pos, var1.height), width=1)
variants1
ggplot() +
geom_bar(data=variants1,aes(var1.pos), width=1)
library(gcookbook) # Load gcookbook for the pg_mean data set
install.packages(gcookbook) # Load gcookbook for the pg_mean data set
install.packages("gcookbook") # Load gcookbook for the pg_mean data set
library("gcookbook") # Load gcookbook for the pg_mean data set
variants1
ggplot(pg_mean, aes(x = group, y = weight)) +
geom_col()
pg_mean
ggplot() +
geom_bar(data=variants1,aes(var1.pos, var1.height), width=1)
ggplot() +
geom_col(data=variants1,aes(var1.pos, var1.height), width=1)
ggplot(pg_mean, aes(x = group, y = weight)) +
geom_col(width = 3, col='red')
ggplot(pg_mean, aes(x = group, y = weight)) +
geom_col(width = 1, col='red')
ggplot() +
geom_col(data=variants1,aes(var1.pos, var1.height), width=1, col='red')
ggplot(pg_mean, aes(x = group, y = weight)) +
geom_col(width = 1, col='red') +
theme_void()
ggplot() +
geom_col(data=variants1,aes(var1.pos, var1.height), width=1, col='red') +
theme_void()
ggplot() +
geom_col(data=variants1,aes(var1.pos, var1.height), width=1, col='red') +
theme_void() +
coord_polar() +
ylim(c(0,NA))
ggplot() +
geom_col(data=variants1,aes(var1.pos, var1.height), width=1, col='red') +
theme_void() +
coord_polar()
ggplot() +
geom_rect(xmin=0, xmax=6000000, ymin= 1.1, ymax=1.5, fill="#eae3dc") +
geom_col(data=variants1,aes(var1.pos, var1.height), width=1, col='red') +
geom_line(data = circles , aes(genome_size,y1), color="#333333",size=3) +
geom_line(data = circles , aes(genome_size,y2), color="#333333",size=3.5) +
#geom_jitter(data = variants1, aes(var1.pos, var1.height), size=3, color="#C02942", height=0.05, width = 0.05, alpha=0.7) +
geom_jitter(data = variants2, aes(var2.pos, var2.height), size=3, color="#ECD078", height=0.05, width = 0.05, alpha=0.7) +
coord_polar() +
ylim(c(0,NA)) +
geom_text(data = ticks, aes(x1, y1, label = "|", angle = angle)) +
geom_text(data = ticks, aes(x1, y2, label = x2, angle = angle), size=5) +
theme_void() +
labs(title="Ploting variant positions across genome") +
theme(plot.title = element_text(hjust=0.5))
ggplot() +
geom_col(data=variants1,aes(var1.pos, var1.height), width=1, col='red') +
theme_void() +
coord_polar()
ggplot() +
geom_col(data=variants1,aes(var1.pos, var1.height), width=1, col='red') +
theme_void() +
coord_polar() +
ylim(c(0,NA))
ggplot() +
geom_rect(xmin=0, xmax=6000000, ymin= 1.1, ymax=1.5, fill="#eae3dc") +
geom_col(data=variants1,aes(var1.pos, var1.height), width=1, col='red') +
geom_line(data = circles , aes(genome_size,y1), color="#333333",size=3) +
geom_line(data = circles , aes(genome_size,y2), color="#333333",size=3.5) +
# geom_jitter(data = variants1, aes(var1.pos, var1.height), size=3, color="#C02942", height=0.05, width = 0.05, alpha=0.7) +
geom_jitter(data = variants2, aes(var2.pos, var2.height), size=3, color="#ECD078", height=0.05, width = 0.05, alpha=0.7) +
coord_polar() +
ylim(c(0,NA)) +
geom_text(data = ticks, aes(x1, y1, label = "|", angle = angle)) +
geom_text(data = ticks, aes(x1, y2, label = x2, angle = angle), size=5) +
theme_void() +
labs(title="Ploting variant positions across genome") +
theme(plot.title = element_text(hjust=0.5))
data=data.frame(
individual=paste( "Mister ", seq(1,60), sep=""),
group=c( rep('A', 10), rep('B', 30), rep('C', 14), rep('D', 6)) ,
value=sample( seq(10,100), 60, replace=T) )
data
to_add = data.frame( matrix(NA, empty_bar*nlevels(data$group), ncol(data)) )
empty_bar=3
to_add = data.frame( matrix(NA, empty_bar*nlevels(data$group), ncol(data)) )
colnames(to_add) = colnames(data) to_add$group=rep(levels(data$group), each=empty_bar)
colnames(to_add) = colnames(data)
to_add$group=rep(levels(data$group), each=empty_bar)
data=rbind(data, to_add) data=data %>% arrange(group) data$id=seq(1, nrow(data))
to_add = data.frame( matrix(NA, empty_bar*nlevels(data$group), ncol(data)) )
colnames(to_add) = colnames(data)
to_add$group=rep(levels(data$group), each=empty_bar)
data=rbind(data, to_add)
data=data %>% arrange(group) data$id=seq(1, nrow(data))
data=data %>% arrange(group)
data$id=seq(1, nrow(data))
data
empty_bar=3
to_add = data.frame( matrix(NA, empty_bar*nlevels(data$group), ncol(data)) )
colnames(to_add) = colnames(data)
to_add$group=rep(levels(data$group), each=empty_bar)
data=rbind(data, to_add)
data=data %>% arrange(group)
data=data %>%
arrange(group)
library(tidyverse)
data=data.frame(
individual=paste( "Mister ", seq(1,60), sep=""),
group=c( rep('A', 10), rep('B', 30), rep('C', 14), rep('D', 6)) ,
value=sample( seq(10,100), 60, replace=T) )
data
empty_bar=3
to_add = data.frame( matrix(NA, empty_bar*nlevels(data$group), ncol(data)) )
colnames(to_add) = colnames(data)
to_add$group=rep(levels(data$group), each=empty_bar)
data=rbind(data, to_add)
data=data %>%
arrange(group)
data
data
data$id=seq(1, nrow(data))
data
label_data=data
number_of_bar=nrow(label_data)
angle= 90 - 360 * (label_data$id-0.5) /number_of_bar # I substract 0.5 because the letter must have the angle of the center of the bars. Not extreme right(1) or extreme left (0) label_data$hjust<-ifelse( angle < -90, 1, 0) #label_data$vjust = -10 label_data$angle<-ifelse(angle < -90, angle+180, angle)
angle
label_data$hjust<-ifelse( angle < -90, 1, 0)
label_data$angle<-ifelse(angle < -90, angle+180, angle)
label_data
base_data=data %>%
group_by(group)%>%
summarize(start=min(id), end=max(id) - empty_bar) %>%
rowwise() %>%
mutate(title=mean(c(start, end)))
base_data=data %>%
group_by(group)%>%
summarize(start=min(id), end=max(id) - empty_bar) %>%
rowwise() %>%
mutate(title=mean(c(start, end)))
install.packages("rsvg")
library(dplyr)
